<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>myfirstblog</title>
      <link href="/posts/f908.html"/>
      <url>/posts/f908.html</url>
      
        <content type="html"><![CDATA[<h1 id="实习第十周学习总结（10月24日-10月29）"><a href="#实习第十周学习总结（10月24日-10月29）" class="headerlink" title="实习第十周学习总结（10月24日-10月29）"></a>实习第十周学习总结（10月24日-10月29）</h1><h2 id="打印功能实现"><a href="#打印功能实现" class="headerlink" title="打印功能实现"></a>打印功能实现</h2><h3 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h3><p>在我们的实际工作中，经常需要实现打印功能。但由于历史原因，Java 提供的打印功能一直都比较弱。实际上最初的 jdk 根本不支持打印，直到 jdk1.1 才引入了很轻量的打印支持。实际上，SUN 公司也一直致力于 Java 打印功能的完善，而 Java2 平台则终于有了一个健壮的打印模式的开端， jdk1.4 则提供了一套完整的”Java 打印服务 API” （Java Print Service API），它对已有的打印功能是积极的补充。</p><p>这里打印对象主要是图片和pdf文件两种常见形式，其他office文件可以通过相应程序转成pdf进行打印，比如aspose(收费，需要破解)&#x2F;openoffice(需要先搭建本地服务)&#x2F;Jacob(只有windows)</p><h3 id="二、打印实践"><a href="#二、打印实践" class="headerlink" title="二、打印实践"></a>二、打印实践</h3><p>首先要保证电脑GUI打印能正常运行，否则连打印机都没有连接，那怎么打印？</p><h4 id="1、JPG图片打印"><a href="#1、JPG图片打印" class="headerlink" title="1、JPG图片打印"></a>1、JPG图片打印</h4><p>打印JPG图片格式的文件，本次采用的Java原生的打印方式。jdk1.4之后对打印功能有了很好的支持。Java 的打印 API 主要存在于 java.awt.print 包中。而 jdk1.4 新增的类则主要存在于 javax.print 包及其相应的子包 javax.print.event 和 javax.print.attribute 中。其中** javax.print 包中主要包含打印服务的相关类，而 javax.print.event 则包含打印事件的相关定义，javax.print.attribute 则包括打印服务的可用属性列表等**。可以很好的解决打印JPG图片格式的需求。</p><p>优点：jdk的原生支持的打印功能，可直接使用，支持设置各项打印参数。</p><p>缺点：局限性较大，只能打印一些图片和文本格式的文件。</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrintUtil</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * 打印图片     * @param file     * @param printerName     * @throws PrintException     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token class-name">JPGPrint</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">,</span><span class="token class-name">String</span> printerName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">PrintException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>file <span class="token operator">==</span> <span class="token keyword">null</span><span class="token operator">||</span>printerName<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"缺少打印文件或者缺少打印机参数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">InputStream</span> fis <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​    </p><pre class="line-numbers language-java" data-language="java"><code class="language-java">    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 设置打印格式，如果未确定类型，可选择autosense</span>        <span class="token comment">// 设置为jpg格式</span>        <span class="token class-name">DocFlavor</span> flavor <span class="token operator">=</span> <span class="token class-name">DocFlavor</span><span class="token punctuation">.</span><span class="token constant">INPUT_STREAM</span><span class="token punctuation">.</span><span class="token constant">JPEG</span><span class="token punctuation">;</span>        <span class="token comment">// 设置打印参数</span>        <span class="token class-name">PrintRequestAttributeSet</span> hashset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashPrintRequestAttributeSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//份数</span>        hashset<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Copies</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//装订</span>        <span class="token comment">//hashset.add(Finishings.STAPLE);</span>        <span class="token comment">//单双面</span>        hashset<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Sides</span><span class="token punctuation">.</span><span class="token constant">DUPLEX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 颜色</span>        hashset<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Chromaticity</span><span class="token punctuation">.</span><span class="token constant">COLOR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 定位打印服务</span>        <span class="token class-name">PrintService</span> printService <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>printerName <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">//获得本台电脑连接的所有打印机</span>            <span class="token class-name">PrintService</span><span class="token punctuation">[</span><span class="token punctuation">]</span> printServices <span class="token operator">=</span> <span class="token class-name">PrinterJob</span><span class="token punctuation">.</span><span class="token function">lookupPrintServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>printServices <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> printServices<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"打印失败，未找到可用打印机，请检查。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token comment">//匹配指定打印机</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> printServices<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>printServices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>printerName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    printService <span class="token operator">=</span> printServices<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>printService<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"打印失败，未找到名称为"</span> <span class="token operator">+</span> printerName <span class="token operator">+</span> <span class="token string">"的打印机，请检查。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// 构造待打印的文件流</span>        fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Doc</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDoc</span><span class="token punctuation">(</span>fis<span class="token punctuation">,</span> flavor<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 创建打印作业</span>        <span class="token class-name">DocPrintJob</span> job <span class="token operator">=</span> printService<span class="token punctuation">.</span><span class="token function">createPrintJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        job<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> hashset<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"文件未找到"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// 关闭打印的文件流</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>fis <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">JPGPrint</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"D:\\share\\111.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"MI"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2、图片-x2F-pdf原生打印"><a href="#2、图片-x2F-pdf原生打印" class="headerlink" title="2、图片&#x2F;pdf原生打印"></a>2、图片&#x2F;pdf原生打印</h4><p>这里pdf打印可能和硬件有关系，需要安装Adobe Reader，而且现在pdf也不使用此方法打印，可以用作借鉴</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrintUtil</span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * 打印服务     * @param file 文件     * @Param printerName 打印机名字     * @param num 打印份数     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">paperPrint</span><span class="token punctuation">(</span><span class="token class-name">File</span> file<span class="token punctuation">,</span> <span class="token class-name">String</span> printerName<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token comment">// 构建打印请求属性集</span>        <span class="token class-name">DocFlavor</span> flavor <span class="token operator">=</span> <span class="token class-name">DocFlavor</span><span class="token punctuation">.</span><span class="token constant">INPUT_STREAM</span><span class="token punctuation">.</span><span class="token constant">AUTOSENSE</span><span class="token punctuation">;</span>        <span class="token comment">// 设置打印格式</span>        <span class="token class-name">PrintRequestAttributeSet</span> pras <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashPrintRequestAttributeSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 查找所有的打印服务</span>        <span class="token class-name">PrintService</span><span class="token punctuation">[</span><span class="token punctuation">]</span> printServices <span class="token operator">=</span> <span class="token class-name">PrintServiceLookup</span><span class="token punctuation">.</span><span class="token function">lookupPrintServices</span><span class="token punctuation">(</span>flavor<span class="token punctuation">,</span> pras<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 打印服务</span>        <span class="token class-name">PrintService</span> printService <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PrintService</span> ps <span class="token operator">:</span> printServices<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> psName <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 选用指定打印机，需要精确查询打印机就用equals，模糊查询用contains，这里使用了模糊查找</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>psName<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>printerName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                printService<span class="token operator">=</span>ps<span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// 如果找不到打印机</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>printService <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"找不到打印机"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// 文件不存在</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"文件不存在"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">String</span> fileName <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 获取图片后缀名，设置打印文件格式</span>        <span class="token class-name">String</span> suffix <span class="token operator">=</span> fileName<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>fileName<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>suffix<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">case</span> <span class="token string">"jpg"</span><span class="token operator">:</span>            <span class="token keyword">case</span> <span class="token string">"jpeg"</span><span class="token operator">:</span>                flavor <span class="token operator">=</span> <span class="token class-name">DocFlavor</span><span class="token punctuation">.</span><span class="token constant">INPUT_STREAM</span><span class="token punctuation">.</span><span class="token constant">JPEG</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">"png"</span><span class="token operator">:</span>                flavor <span class="token operator">=</span> <span class="token class-name">DocFlavor</span><span class="token punctuation">.</span><span class="token constant">INPUT_STREAM</span><span class="token punctuation">.</span><span class="token constant">PNG</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">"pdf"</span><span class="token operator">:</span>                flavor <span class="token operator">=</span> <span class="token class-name">DocFlavor</span><span class="token punctuation">.</span><span class="token constant">INPUT_STREAM</span><span class="token punctuation">.</span><span class="token constant">PDF</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token string">"gif"</span><span class="token operator">:</span>                flavor <span class="token operator">=</span> <span class="token class-name">DocFlavor</span><span class="token punctuation">.</span><span class="token constant">INPUT_STREAM</span><span class="token punctuation">.</span><span class="token constant">GIF</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">default</span><span class="token operator">:</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"其他类别文件不支持打印"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// 设置打印文件名</span>        pras<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JobName</span><span class="token punctuation">(</span>fileName<span class="token punctuation">,</span> <span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token constant">CHINA</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 设置打印方向</span>        pras<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">OrientationRequested</span><span class="token punctuation">.</span><span class="token constant">LANDSCAPE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 设置打印区域</span>        <span class="token comment">//MediaPrintableArea mp = new MediaPrintableArea(0, 100, 230, 203, Size2DSyntax.MM);</span>        <span class="token comment">//pras.add(mp);</span>        <span class="token comment">// 设置彩打或者黑白打印</span>        pras<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Chromaticity</span><span class="token punctuation">.</span><span class="token constant">MONOCHROME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">HashDocAttributeSet</span> das <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashDocAttributeSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">long</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// 使用打印服务生成打印任务</span>                <span class="token class-name">DocPrintJob</span> job <span class="token operator">=</span> printService<span class="token punctuation">.</span><span class="token function">createPrintJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// 获取需要打印的文档类doc</span>                <span class="token class-name">SimpleDoc</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleDoc</span><span class="token punctuation">(</span>fis<span class="token punctuation">,</span> flavor<span class="token punctuation">,</span> das<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment">// 监听打印任务</span>                job<span class="token punctuation">.</span><span class="token function">addPrintJobListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrintJobListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token annotation punctuation">@Override</span>                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printDataTransferCompleted</span><span class="token punctuation">(</span><span class="token class-name">PrintJobEvent</span> pje<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"成功发送任务："</span> <span class="token operator">+</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                        <span class="token annotation punctuation">@Override</span>                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printJobCompleted</span><span class="token punctuation">(</span><span class="token class-name">PrintJobEvent</span> pje<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"打印任务完成！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                        <span class="token annotation punctuation">@Override</span>                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printJobFailed</span><span class="token punctuation">(</span><span class="token class-name">PrintJobEvent</span> pje<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"打印任务失败："</span> <span class="token operator">+</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                        <span class="token annotation punctuation">@Override</span>                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printJobCanceled</span><span class="token punctuation">(</span><span class="token class-name">PrintJobEvent</span> pje<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"取消打印任务！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                        <span class="token annotation punctuation">@Override</span>                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printJobNoMoreEvents</span><span class="token punctuation">(</span><span class="token class-name">PrintJobEvent</span> pje<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"没有更多方法提供打印机调用！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                        <span class="token annotation punctuation">@Override</span>                    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">printJobRequiresAttention</span><span class="token punctuation">(</span><span class="token class-name">PrintJobEvent</span> pje<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"纸张已用完"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                job<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> pras<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">PrintException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">paperPrint</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"D:\\share\\111.png"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"MI"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//paperPrint(new File("D:\\share\\123.pdf"),"MI",1);</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3、PDF文件格式打印实现"><a href="#3、PDF文件格式打印实现" class="headerlink" title="3、PDF文件格式打印实现"></a>3、PDF文件格式打印实现</h4><p>这里使用Apache PDFbox来实现进行PDF文件格式的打印。Apache PDFbox是一个开源的、基于Java的、支持PDF文档生成的工具库，它可以用于创建新的PDF文档，修改现有的PDF文档，还可以从PDF文档中提取所需的内容。Apache PDFBox还包含了数个命令行工具。在此，我们只研究打印功能。</p><p>优点：功能强大，开源软件，较完美的解决了PDF格式文件的一系列处理，使用方便<br>首先导入依赖</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>dependency<span class="token operator">></span>  <span class="token operator">&lt;</span>groupId<span class="token operator">></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>pdfbox<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>  <span class="token operator">&lt;</span>artifactId<span class="token operator">></span>pdfbox<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>  <span class="token operator">&lt;</span>version<span class="token operator">></span><span class="token number">2.0</span><span class="token number">.6</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>具体代码实现</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrintUtil</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PrinterJob</span> <span class="token function">getPrintServiceByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> printerName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>        <span class="token class-name">PrinterJob</span> job <span class="token operator">=</span> <span class="token class-name">PrinterJob</span><span class="token punctuation">.</span><span class="token function">getPrinterJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 遍历查询打印机名称</span>        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PrintService</span> ps <span class="token operator">:</span> <span class="token class-name">PrinterJob</span><span class="token punctuation">.</span><span class="token function">lookupPrintServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> psName <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 选用指定打印机，需要精确查询打印机就用equals，模糊查询用contains，这里使用了模糊查找</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>psName<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>printerName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                job<span class="token punctuation">.</span><span class="token function">setPrintService</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"未找到打印机"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"打印失败，未找到名称为"</span> <span class="token operator">+</span> printerName <span class="token operator">+</span> <span class="token string">"的打印机，请检查你的打印机名字"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> job<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 获取打印纸的大小范围     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Paper</span> <span class="token function">getPaper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Paper</span> paper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 默认为A4纸张，对应像素宽和高分别为 595, 842</span>        <span class="token keyword">int</span> width <span class="token operator">=</span> <span class="token number">595</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> height <span class="token operator">=</span> <span class="token number">842</span><span class="token punctuation">;</span>        <span class="token comment">// 设置边距，单位是像素，10mm边距，对应 28px</span>        <span class="token keyword">int</span> marginLeft <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> marginRight <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> marginTop <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> marginBottom <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        paper<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 下面一行代码，解决了打印内容为空的问题</span>        paper<span class="token punctuation">.</span><span class="token function">setImageableArea</span><span class="token punctuation">(</span>marginLeft<span class="token punctuation">,</span> marginRight<span class="token punctuation">,</span> width <span class="token operator">-</span> <span class="token punctuation">(</span>marginLeft <span class="token operator">+</span> marginRight<span class="token punctuation">)</span><span class="token punctuation">,</span> height <span class="token operator">-</span> <span class="token punctuation">(</span>marginTop <span class="token operator">+</span> marginBottom<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> paper<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token comment">/**     * 设置打印属性     * @param     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">paperPDFPrint</span><span class="token punctuation">(</span><span class="token class-name">PDDocument</span> document<span class="token punctuation">,</span> <span class="token class-name">PrinterJob</span> job<span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// 设置纸张及缩放</span>            <span class="token class-name">PDFPrintable</span> pdfPrintable <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDFPrintable</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token class-name">Scaling</span><span class="token punctuation">.</span><span class="token constant">ACTUAL_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 设置多页打印</span>            <span class="token class-name">Book</span> book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 设置打印格式</span>            <span class="token class-name">PageFormat</span> pageFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//设置纸张</span>            pageFormat<span class="token punctuation">.</span><span class="token function">setPaper</span><span class="token punctuation">(</span><span class="token function">getPaper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 设置打印纸的方向,这是纵向</span>            pageFormat<span class="token punctuation">.</span><span class="token function">setOrientation</span><span class="token punctuation">(</span><span class="token class-name">PageFormat</span><span class="token punctuation">.</span><span class="token constant">PORTRAIT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 设置一些属性 是否缩放 打印张数等</span>            book<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>pdfPrintable<span class="token punctuation">,</span> pageFormat<span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getNumberOfPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            job<span class="token punctuation">.</span><span class="token function">setPageable</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 设置打印份数</span>            job<span class="token punctuation">.</span><span class="token function">setCopies</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//添加打印属性</span>            <span class="token class-name">HashPrintRequestAttributeSet</span> pars <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashPrintRequestAttributeSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 设置单双页</span>            pars<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Sides</span><span class="token punctuation">.</span><span class="token constant">ONE_SIDED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 设置彩打或者黑白打印</span>            pars<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Chromaticity</span><span class="token punctuation">.</span><span class="token constant">MONOCHROME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 打印质量</span>            pars<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">PrintQuality</span><span class="token punctuation">.</span><span class="token constant">NORMAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 这是直接打印</span>            job<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>pars<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">PrinterException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"未正常连接打印机"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"打印机打印异常"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>        <span class="token comment">/**     * 打印pdf文件     * @param pdfPath     * @param printerName     * @return     * @throws Exception     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PDDocument</span> <span class="token function">printPdf</span><span class="token punctuation">(</span><span class="token class-name">String</span> pdfPath<span class="token punctuation">,</span> <span class="token class-name">String</span> printerName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>pdfPath<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">PDDocument</span> document <span class="token operator">=</span> <span class="token class-name">PDDocument</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">PrinterJob</span> job <span class="token operator">=</span> <span class="token function">getPrintServiceByName</span><span class="token punctuation">(</span>printerName<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">paperPDFPrint</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> job<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> document<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>          <span class="token function">printPdf</span><span class="token punctuation">(</span><span class="token string">"D:\\share\\123.pdf"</span><span class="token punctuation">,</span><span class="token string">"MI"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>### <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="三、前端实现打印"><a href="#三、前端实现打印" class="headerlink" title="三、前端实现打印"></a>三、前端实现打印</h3><p>首先是使用下边代码，实现js局部打印功能。参数dom为需要打印的节点，为了保证页面功能的单一性，最好弹出一个新的预览页面完成打印功能。</p><pre class="line-numbers language-jsp" data-language="jsp"><code class="language-jsp">function print(dom)&#123;   var body &#x3D; document.body.innerHTML;&#x2F;&#x2F;先获取当前页的html代码       document.body.innerHTML &#x3D; document.querySelector(dom).innerHTML;&#x2F;&#x2F;需要打印的页面       window.print();       document.body.innerHTML &#x3D;body;&#x2F;&#x2F;打印完成之后，还原界面&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
